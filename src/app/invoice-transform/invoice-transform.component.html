<div class="space-y-8">
  <!-- Hiba√ºzenet -->
  <div *ngIf="error" class="bg-red-100 text-red-800 px-4 py-2 rounded">
    {{ error }}
  </div>

  <!-- Fejl√©c + kivonat v√°laszt√≥ -->
  <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
    <h2 class="text-xl font-semibold text-gray-800">Bankkivonat kalkul√°ci√≥</h2>

    <div *ngIf="statements.length" class="flex items-center gap-2">
      <label class="text-sm font-medium text-gray-700">Kivonat:</label>
      <select
        class="border border-gray-300 rounded-md px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
        [(ngModel)]="selectedStatementId"
        (ngModelChange)="selectStatement($event)"
      >
        <option *ngFor="let s of statements" [value]="s.id">
          {{ s.id }}
        </option>
      </select>
    </div>
  </div>

  <!-- Loader -->
  <div *ngIf="isLoading" class="text-gray-500 text-sm">
    Adatok bet√∂lt√©se...
  </div>

  <!-- √ñsszegz≈ë k√°rty√°k -->
  <div
    *ngIf="!isLoading && currentStatement"
    class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"
  >
    <app-summary-card
      icon="üí∏"
      title="√ñsszes kiad√°s"
      [value]="totalSpending"
      colorClass="text-red-600"
    ></app-summary-card>

    <app-summary-card
      icon="üí∂"
      title="√ñsszes bev√©tel"
      [value]="totalIncome"
      colorClass="text-green-600"
    ></app-summary-card>

    <app-summary-card
      icon="‚úÖ"
      title="Kijel√∂lt t√©telek √∂sszege"
      [value]="selectedTotal"
      colorClass="text-blue-600"
    ></app-summary-card>
  </div>

  <!-- Tranzakci√≥k t√°bl√°zata + checkboxok -->
  <div *ngIf="!isLoading && transactions.length" appTailwindBlueBox>
    <div class="flex items-center justify-between mb-3">
      <h3 class="font-semibold text-gray-800">Tranzakci√≥k</h3>

      <div class="flex gap-2">
        <button
          type="button"
          appButton="blue"
          (click)="selectAll()"
        >
          Mind kijel√∂l
        </button>
        <button
          type="button"
          appButton="secondary"
          (click)="deselectAll()"
        >
          Kijel√∂l√©s t√∂rl√©se
        </button>
      </div>
    </div>

    <div class="overflow-x-auto">
      <table
        class="min-w-full border border-gray-200 text-sm"
        appTailwindStyledTable
      >
        <thead>
        <tr>
          <th class="border px-2 py-1 text-center">
            <input
              type="checkbox"
              (change)="($event.target.checked ? selectAll() : deselectAll())"
            />
          </th>
          <th class="border px-2 py-1">D√°tum</th>
          <th class="border px-2 py-1">Le√≠r√°s</th>
          <th class="border px-2 py-1">Kateg√≥ria</th>
          <th class="border px-2 py-1 text-right">√ñsszeg</th>
          <th class="border px-2 py-1 text-right">Egyenleg</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let tx of transactions">
          <td class="border px-2 py-1 text-center">
            <input type="checkbox" [(ngModel)]="tx.selected" />
          </td>
          <td class="border px-2 py-1">
            {{ tx.konyvelesi_datum }}
          </td>
          <td class="border px-2 py-1">
            {{ tx.leiras }}
          </td>
          <td class="border px-2 py-1">
            {{ tx.category }}
          </td>
          <td class="border px-2 py-1 text-right">
            {{ tx.osszeg | number: '1.0-2' }} HUF
          </td>
          <td class="border px-2 py-1 text-right">
            {{ tx.egyenleg | number: '1.0-2' }} HUF
          </td>
        </tr>
        </tbody>
      </table>
    </div>

    <!-- Kijel√∂lt t√©telek √∂sszege -->
    <div class="mt-4 font-semibold">
      Kijel√∂lt t√©telek √∂sszesen:
      <span
        [ngClass]="{
          'text-red-600': selectedTotal < 0,
          'text-green-600': selectedTotal > 0,
          'text-gray-700': selectedTotal === 0
        }"
      >
        {{ selectedTotal | number: '1.0-2' }} HUF
      </span>
    </div>
  </div>

  <!-- Ha nincs tranzakci√≥ -->
  <div
    *ngIf="!isLoading && !transactions.length"
    class="text-gray-500 text-sm"
  >
    Nincs megjelen√≠thet≈ë tranzakci√≥.
  </div>
</div>
